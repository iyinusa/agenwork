<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Intelligent Summarization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { border-left: 4px solid #4CAF50; background-color: #f1f8e9; }
        .error { border-left: 4px solid #f44336; background-color: #ffebee; }
        .info { border-left: 4px solid #2196F3; background-color: #e3f2fd; }
        .warning { border-left: 4px solid #ff9800; background-color: #fff3e0; }
        
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background-color: #45a049; }
        button:disabled { background-color: #cccccc; cursor: not-allowed; }
        
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .result {
            margin-top: 10px;
            padding: 15px;
            border-radius: 4px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            white-space: pre-wrap;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß† Intelligent Summarization Test Suite</h1>
        <p>This page tests the enhanced AI-powered summarization with intelligent type and length detection.</p>
        
        <div class="test-section info">
            <h3>üîç AI Environment Check</h3>
            <button onclick="checkAIEnvironment()">Check AI Availability</button>
            <div id="env-check-result"></div>
        </div>

        <div class="test-section">
            <h3>üìù Test Sample Texts</h3>
            
            <h4>Test 1: Request Key Points Summary</h4>
            <textarea id="prompt1" readonly>Please provide key points from this article: "Artificial Intelligence has revolutionized various industries over the past decade. From healthcare to finance, AI systems are now capable of performing complex tasks that were once exclusive to human expertise. Machine learning algorithms can analyze vast amounts of data to identify patterns and make predictions. In healthcare, AI assists in medical diagnosis, drug discovery, and personalized treatment plans. Financial institutions use AI for fraud detection, algorithmic trading, and risk assessment. The automotive industry has embraced AI for autonomous vehicles and predictive maintenance. However, the rapid advancement of AI also raises concerns about job displacement, privacy, and ethical considerations. As we move forward, it's crucial to develop AI systems that are transparent, fair, and beneficial to society as a whole."</textarea>
            <button onclick="testIntelligentSummarization('prompt1', 'result1')">Test Key Points Detection</button>
            <div class="result" id="result1"></div>

            <h4>Test 2: Request TL;DR Summary</h4>
            <textarea id="prompt2" readonly>Give me a quick TL;DR of this news: "The Global Climate Summit concluded yesterday with participating nations agreeing to ambitious new targets for carbon emission reductions. The summit, attended by representatives from 195 countries, resulted in a comprehensive agreement that includes a commitment to achieve net-zero emissions by 2050. Key provisions include increased funding for renewable energy projects in developing countries, stricter regulations on industrial emissions, and the establishment of a global carbon trading system. Environmental activists praised the agreement as a significant step forward, while some critics argue that the targets may be too ambitious given current technological limitations. The implementation of these measures will begin next year, with quarterly progress reviews scheduled throughout the implementation period."</textarea>
            <button onclick="testIntelligentSummarization('prompt2', 'result2')">Test TL;DR Detection</button>
            <div class="result" id="result2"></div>

            <h4>Test 3: Request Headline Summary</h4>
            <textarea id="prompt3" readonly>Create a catchy headline for this story: "A team of researchers at MIT has developed a new type of battery that can charge electric vehicles in under 30 seconds. The breakthrough involves a novel lithium-metal architecture that overcomes previous limitations related to charging speed and battery life. Traditional lithium-ion batteries typically require 30-60 minutes for a full charge, making this advancement a potential game-changer for electric vehicle adoption. The new battery technology also shows improved longevity, maintaining 90% of its capacity after 10,000 charge cycles. The research team plans to collaborate with automotive manufacturers to begin pilot testing within the next two years. If successful, this technology could address one of the major barriers to widespread electric vehicle adoption - charging time anxiety."</textarea>
            <button onclick="testIntelligentSummarization('prompt3', 'result3')">Test Headline Detection</button>
            <div class="result" id="result3"></div>

            <h4>Test 4: Request Teaser Summary</h4>
            <textarea id="prompt4" readonly>Write an intriguing teaser for this discovery: "Scientists have discovered a new species of deep-sea creature living near volcanic vents 4,000 meters below the ocean surface. The creature, tentatively named Abyssal Lumina, exhibits bioluminescent properties unlike any previously documented marine life. Its unique light-producing cells appear to communicate in complex patterns, suggesting a sophisticated form of underwater communication. The research team spent three years using advanced submersibles to study these creatures in their natural habitat. Initial genetic analysis reveals that Abyssal Lumina may represent an entirely new branch of the evolutionary tree. The discovery has implications for our understanding of life in extreme environments and could provide insights for astrobiology research focused on potential life on other planets."</textarea>
            <button onclick="testIntelligentSummarization('prompt4', 'result4')">Test Teaser Detection</button>
            <div class="result" id="result4"></div>
        </div>

        <div class="test-section">
            <h3>üîß Custom Test</h3>
            <textarea id="custom-prompt" placeholder="Enter your own text and request type here...">Summarize this with medium length: "Your custom text here..."</textarea>
            <button onclick="testIntelligentSummarization('custom-prompt', 'custom-result')">Test Custom Prompt</button>
            <div class="result" id="custom-result"></div>
        </div>

        <div class="test-section">
            <h3>üìä Test Results Summary</h3>
            <div id="summary-results"></div>
        </div>
    </div>

    <script>
        // Global test results tracking
        let testResults = [];

        async function checkAIEnvironment() {
            const resultDiv = document.getElementById('env-check-result');
            resultDiv.innerHTML = '<div class="loading"></div> Checking AI environment...';

            try {
                if (typeof window.debugAI === 'function') {
                    const result = await window.debugAI();
                    resultDiv.innerHTML = `<div class="success"><pre>${JSON.stringify(result, null, 2)}</pre></div>`;
                } else {
                    // Manual check
                    const checks = {
                        windowAIAgent: typeof window.AIAgent !== 'undefined',
                        windowSummarizer: typeof window.Summarizer !== 'undefined',
                        windowAISummarizer: typeof window.AISummarizer !== 'undefined',
                        windowLanguageModel: typeof window.LanguageModel !== 'undefined',
                        windowTranslator: typeof window.Translator !== 'undefined',
                        windowWriter: typeof window.Writer !== 'undefined',
                        chromeAI: typeof chrome !== 'undefined' && typeof chrome.aiOriginTrial !== 'undefined',
                        chromeVersion: navigator.userAgent.match(/Chrome\/(\d+)/)?.[1] || 'Unknown'
                    };
                    
                    resultDiv.innerHTML = `<div class="info"><pre>${JSON.stringify(checks, null, 2)}</pre></div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error checking AI environment: ${error.message}</div>`;
            }
        }

        async function testIntelligentSummarization(promptId, resultId) {
            const promptElement = document.getElementById(promptId);
            const resultDiv = document.getElementById(resultId);
            const prompt = promptElement.value;
            
            if (!prompt.trim()) {
                resultDiv.innerHTML = '<div class="error">Please enter a prompt to test</div>';
                return;
            }

            resultDiv.innerHTML = '<div class="loading"></div> Testing intelligent summarization...';

            try {
                // Simulate the AI agent flow
                const testResult = await simulateIntelligentSummarization(prompt);
                
                // Record test result
                testResults.push({
                    prompt: prompt.substring(0, 100) + '...',
                    result: testResult,
                    timestamp: new Date().toISOString()
                });

                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>üéØ Detected Intent Analysis:</h4>
                        <pre>${JSON.stringify(testResult.intentAnalysis, null, 2)}</pre>
                        <h4>üìÑ Generated Summary:</h4>
                        <p>${testResult.summary}</p>
                        <h4>‚öôÔ∏è Summary Options Used:</h4>
                        <pre>${JSON.stringify(testResult.summaryOptions, null, 2)}</pre>
                    </div>
                `;

                updateSummaryResults();

            } catch (error) {
                console.error('Test error:', error);
                resultDiv.innerHTML = `<div class="error">Test failed: ${error.message}</div>`;
                
                testResults.push({
                    prompt: prompt.substring(0, 100) + '...',
                    error: error.message,
                    timestamp: new Date().toISOString()
                });
                updateSummaryResults();
            }
        }

        async function simulateIntelligentSummarization(prompt) {
            // Mock the intelligent summarization flow
            
            // Step 1: Simulate intent detection
            const intentAnalysis = simulateIntentDetection(prompt);
            
            // Step 2: Simulate summary generation with detected options
            const summaryOptions = {
                type: intentAnalysis.summarization_type || 'key-points',
                length: intentAnalysis.summarization_length || 'medium',
                format: 'markdown',
                outputLanguage: 'en'
            };

            // Step 3: Generate mock summary based on detected type
            const summary = generateMockSummary(prompt, summaryOptions);

            return {
                intentAnalysis,
                summaryOptions,
                summary
            };
        }

        function simulateIntentDetection(prompt) {
            const lowerPrompt = prompt.toLowerCase();
            
            // Detect summarization type
            let summarization_type = 'key-points'; // default
            if (lowerPrompt.includes('key points') || lowerPrompt.includes('main points')) {
                summarization_type = 'key-points';
            } else if (lowerPrompt.includes('tldr') || lowerPrompt.includes('tl;dr') || lowerPrompt.includes('quick')) {
                summarization_type = 'tldr';
            } else if (lowerPrompt.includes('headline') || lowerPrompt.includes('title') || lowerPrompt.includes('catchy')) {
                summarization_type = 'headline';
            } else if (lowerPrompt.includes('teaser') || lowerPrompt.includes('intriguing') || lowerPrompt.includes('preview')) {
                summarization_type = 'teaser';
            }

            // Detect length preference
            let summarization_length = 'medium'; // default
            if (lowerPrompt.includes('short') || lowerPrompt.includes('brief') || lowerPrompt.includes('quick')) {
                summarization_length = 'short';
            } else if (lowerPrompt.includes('long') || lowerPrompt.includes('detailed') || lowerPrompt.includes('comprehensive')) {
                summarization_length = 'long';
            }

            return {
                primary: 'summarize',
                secondary: [],
                confidence: 0.95,
                summarization_type,
                summarization_length,
                craftedPrompt: prompt
            };
        }

        function generateMockSummary(prompt, options) {
            const { type, length } = options;
            
            // Extract content from prompt (remove the instruction part)
            const contentMatch = prompt.match(/["'](.*?)["']/) || prompt.match(/:\s*(.+)$/);
            const content = contentMatch ? contentMatch[1] : prompt;
            
            // Generate different summaries based on type
            switch (type) {
                case 'key-points':
                    return generateKeyPointsSummary(content, length);
                case 'tldr':
                    return generateTLDRSummary(content, length);
                case 'headline':
                    return generateHeadlineSummary(content, length);
                case 'teaser':
                    return generateTeaserSummary(content, length);
                default:
                    return generateKeyPointsSummary(content, length);
            }
        }

        function generateKeyPointsSummary(content, length) {
            const basePoints = [
                "‚Ä¢ Main topic identified and analyzed",
                "‚Ä¢ Key concepts and their relationships",
                "‚Ä¢ Important implications and outcomes",
                "‚Ä¢ Notable trends or patterns mentioned"
            ];
            
            if (length === 'short') {
                return basePoints.slice(0, 2).join('\n');
            } else if (length === 'long') {
                return basePoints.concat([
                    "‚Ä¢ Additional context and background information",
                    "‚Ä¢ Supporting details and examples",
                    "‚Ä¢ Future considerations and next steps"
                ]).join('\n');
            }
            return basePoints.join('\n');
        }

        function generateTLDRSummary(content, length) {
            if (length === 'short') {
                return "TL;DR: Key information summarized in one concise sentence.";
            } else if (length === 'long') {
                return "TL;DR: Comprehensive overview covering main points, implications, and key takeaways from the content in a digestible format.";
            }
            return "TL;DR: Essential information and main conclusions presented in a quick, easy-to-read format.";
        }

        function generateHeadlineSummary(content, length) {
            if (length === 'short') {
                return "Breaking: Major Development Announced";
            } else if (length === 'long') {
                return "Revolutionary Breakthrough: Comprehensive Analysis of Recent Major Development and Its Far-Reaching Implications";
            }
            return "Significant Development: Important News with Key Implications";
        }

        function generateTeaserSummary(content, length) {
            if (length === 'short') {
                return "Discover what's changing everything...";
            } else if (length === 'long') {
                return "An intriguing development that could reshape our understanding and approach to this field. What researchers discovered will surprise you and potentially change the way we think about this topic forever.";
            }
            return "Something remarkable has been discovered that could change everything. Find out what makes this so special...";
        }

        function updateSummaryResults() {
            const summaryDiv = document.getElementById('summary-results');
            const successful = testResults.filter(r => !r.error).length;
            const failed = testResults.filter(r => r.error).length;
            
            summaryDiv.innerHTML = `
                <div class="info">
                    <h4>üìà Test Statistics</h4>
                    <p>‚úÖ Successful tests: ${successful}</p>
                    <p>‚ùå Failed tests: ${failed}</p>
                    <p>üìä Total tests: ${testResults.length}</p>
                </div>
            `;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üß† Intelligent Summarization Test Suite loaded');
            console.log('Available window objects:', {
                AIAgent: typeof window.AIAgent,
                Summarizer: typeof window.Summarizer,
                LanguageModel: typeof window.LanguageModel,
                debugAI: typeof window.debugAI
            });
        });
    </script>
</body>
</html>